<div *ngIf="loading" class="text-center py-8">
  <i class="pi pi-spin pi-spinner text-4xl"></i>
  <p class="mt-4">Loading products...</p>
</div>

<div *ngIf="!loading && products.length > 0">
  
  <div class="container mx-auto px-4 py-8">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
      
      <div class="flex flex-col justify-between">
        <div class="mb-20 lg:mb-44">
          <h1 class="text-3xl lg:text-[48px] uppercase font-bold">New Collection</h1>
          <h2 class="text-2xl lg:text-[36px] font-semibold">
            Summer <br />
            2024
          </h2>
        </div>

        <div class="flex flex-col sm:flex-row justify-between items-center gap-4 px-4 py-2">
          <div
            (click)="goToProductsPage()"
            class="bg-[#D9D9D9] px-10 flex gap-4 py-2 cursor-pointer hover:bg-[#c9c9c9] transition-colors"
          >
            <button class="font-semibold">Go To Shop</button>
            <button><i class="fa-solid fa-arrow-right-long"></i></button>
          </div>

          <div>
            <button
              (click)="prevSlider1()"
              class="bg-[#A3A3A3] mx-2 p-2 border border-black hover:bg-[#8a8a8a] transition-colors"
            >
              <i class="fa-solid fa-chevron-left"></i>
            </button>
            <button
              (click)="nextSlider1()"
              class="bg-[#A3A3A3] mx-2 p-2 border border-black hover:bg-[#8a8a8a] transition-colors"
            >
              <i class="fa-solid fa-chevron-right"></i>
            </button>
          </div>
        </div>
      </div>

      <div
        *ngFor="let product of slider1Products"
        class="bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer"
        (click)="goToProductDetails(product._id)"
      >
        <div class="relative mb-4">
          <img
            [src]="product.image"
            [alt]="product.title"
            class="w-full h-60 lg:h-80 object-contain rounded-lg bg-gray-50"
            (error)="$any($event.target).src = 'https://via.placeholder.com/300x300?text=No+Image'"
          />

          <p-tag
            [value]="getInventoryStatus(product.quantity)"
            [severity]="getSeverity(getInventoryStatus(product.quantity))"
            class="absolute top-2 left-2"
          />

          <span
            *ngIf="product.discountRate"
            class="absolute top-2 right-2 bg-red-500 text-white px-3 py-1 rounded text-sm font-semibold"
          >
            -{{ product.discountRate }}%
          </span>
        </div>

        <!-- Category -->
        <!-- <div class="mb-2">
          <span class="text-xs text-gray-500 uppercase font-semibold">{{
            product.categoryName
          }}</span>
        </div> -->

        <div class="mb-3 font-semibold text-lg h-14 overflow-hidden">
          {{ product.title }}
        </div>

        <!-- Product Description -->
        <!-- <div class="mb-3 text-sm text-gray-600 h-12 overflow-hidden">
          {{ product.description }}
        </div> -->

        <!-- Rating -->
        <!-- <div class="flex items-center gap-2 mb-4">
          <div class="flex items-center">
            <i class="pi pi-star-fill text-yellow-500 text-sm"></i>
            <span class="ml-1 text-sm font-semibold">{{ product.averageRating || 0 }}</span>
            <span class="ml-1 text-xs text-gray-500">({{ product.reviewCount }})</span>
          </div>
        </div> -->

        <div class="flex justify-between items-center">
          <div class="flex flex-col">
            <div class="font-bold text-2xl text-green-600">
              ${{ product.discountPrice || product.price }}
            </div>
            <div *ngIf="product.discountPrice" class="text-sm text-gray-400 line-through">
              ${{ product.price }}
            </div>
          </div>

          <div class="flex gap-2" (click)="$event.stopPropagation()">
            <p-button
              icon="pi pi-heart"
              [outlined]="true"
              severity="secondary"
              (onClick)="addToWishlist(product)"
              [title]="'Add to Wishlist'"
            />
            <p-button
              icon="pi pi-shopping-cart"
              (onClick)="addToCart(product)"
              [title]="'Add to Cart'"
            />
          </div>
        </div>

        <div class="mt-3 text-xs text-gray-500">
          <span *ngIf="product.quantity > 0">{{ product.quantity }} in stock</span>
          <span *ngIf="product.quantity === 0" class="text-red-500 font-semibold">Out of stock</span>
        </div>
      </div>
    </div>
  </div>

  <div class="container mx-auto px-4 py-8 mt-16">
    <h1 class="text-3xl lg:text-[48px] uppercase font-bold mb-8">
      New <br />
      This week
    </h1>

    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-8">
      <div
        *ngFor="let product of slider2Products"
        class="bg-white border border-gray-200 rounded-lg p-3 shadow-sm hover:shadow-md transition-shadow cursor-pointer"
        (click)="goToProductDetails(product._id)"
      >
        <div class="relative mb-3">
          <img
            [src]="product.image"
            [alt]="product.title"
            class="w-full h-40 object-contain rounded-lg bg-gray-50"
            (error)="$any($event.target).src = 'https://via.placeholder.com/200x200?text=No+Image'"
          />

          <span
            *ngIf="product.discountRate"
            class="absolute top-2 right-2 bg-red-500 text-white px-2 py-1 rounded text-xs font-semibold"
          >
            -{{ product.discountRate }}%
          </span>
        </div>

        <div class="mb-2 font-semibold text-sm h-10 overflow-hidden">
          {{ product.title }}
        </div>

        <div class="flex flex-col">
          <div class="font-bold text-lg text-green-600">
            ${{ product.discountPrice || product.price }}
          </div>
          <div *ngIf="product.discountPrice" class="text-xs text-gray-400 line-through">
            ${{ product.price }}
          </div>
        </div>
      </div>
    </div>

    <div class="flex justify-center items-center">
      <div>
        <button
          (click)="prevSlider2()"
          class="bg-[#A3A3A3] mx-2 p-2 border border-black hover:bg-[#8a8a8a] transition-colors"
        >
          <i class="fa-solid fa-chevron-left"></i>
        </button>
        <button
          (click)="nextSlider2()"
          class="bg-[#A3A3A3] mx-2 p-2 border border-black hover:bg-[#8a8a8a] transition-colors"
        >
          <i class="fa-solid fa-chevron-right"></i>
        </button>
      </div>
    </div>
  </div>

  <div class="container mx-auto px-4 py-8 mt-16">
    <h1 class="text-3xl lg:text-[48px] uppercase font-bold mb-8">
      XIV <br />
      Collections
    </h1>

    <div class="flex flex-col md:flex-row justify-center items-center gap-6 lg:gap-10 mb-8">
      <div
        *ngFor="let product of slider3Products"
        class="w-full md:w-1/3 bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer"
        (click)="goToProductDetails(product._id)"
      >
        <div class="relative mb-4">
          <img
            [src]="product.image"
            [alt]="product.title"
            class="w-full h-64 lg:h-80 object-contain rounded-lg bg-gray-50"
            (error)="$any($event.target).src = 'https://via.placeholder.com/300x300?text=No+Image'"
          />

          <p-tag
            [value]="getInventoryStatus(product.quantity)"
            [severity]="getSeverity(getInventoryStatus(product.quantity))"
            class="absolute top-2 left-2"
          />

          <span
            *ngIf="product.discountRate"
            class="absolute top-2 right-2 bg-red-500 text-white px-3 py-1 rounded text-sm font-semibold"
          >
            -{{ product.discountRate }}%
          </span>
        </div>

        <div class="mb-2">
          <span class="text-xs text-gray-500 uppercase font-semibold">{{
            product.categoryName
          }}</span>
        </div>

        <div class="mb-3 font-semibold text-lg h-14 overflow-hidden">
          {{ product.title }}
        </div>

        <div class="flex justify-between items-center">
          <div class="flex flex-col">
            <div class="font-bold text-2xl text-green-600">
              ${{ product.discountPrice || product.price }}
            </div>
            <div *ngIf="product.discountPrice" class="text-sm text-gray-400 line-through">
              ${{ product.price }}
            </div>
          </div>

          <div class="flex gap-2" (click)="$event.stopPropagation()">
            <p-button
              icon="pi pi-heart"
              [outlined]="true"
              severity="secondary"
              (onClick)="addToWishlist(product)"
              [title]="'Add to Wishlist'"
            />
            <p-button
              icon="pi pi-shopping-cart"
              (onClick)="addToCart(product)"
              [title]="'Add to Cart'"
            />
          </div>
        </div>
      </div>
    </div>

    <div
      (click)="goToProductsPage()"
      class="flex flex-col justify-center items-center mt-8 cursor-pointer hover:text-gray-600 transition-colors"
    >
      <div>
        <p class="text-lg font-semibold">More</p>
      </div>
      <div>
        <i class="fa-solid fa-arrow-down text-xl"></i>
      </div>
    </div>
  </div>
</div>

<div *ngIf="!loading && products.length === 0" class="text-center py-8">
  <p class="text-gray-500">No products available at the moment.</p>
</div>